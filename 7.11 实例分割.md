# 实例分割
实例分割就是机器自动从图像中用目标检测方法框出不同实例，再用语义分割方法在不同实例区域内进行逐像素标记。借一个浅显的说法：语义分割不区分属于相同类别的不同实例。例如，当图像中有多只猫时，语义分割会将两只猫整体的所有像素预测为“猫”这个类别。与此不同的是，实例分割需要区分出哪些像素属于第一只猫、哪些像素属于第二只猫。

基本思路 目标检测+语义分割。
## 1 SDS
核心：MCG+AlexNet+SVM+NMS。

改进：MCG代替SS提取region，用bottom-up分割出的结果，然后把region以及由它组合成boundingboxes来同时优化two-path 的网络，具体来说：
1. 建议生成：通过MCG算法为每个图像生成2k个候选区域；
2. 特征提取：联合训练两个网络，从区域bbox和区域前景提取特征；
3. 区域分类：基于CNN最后的特征训练SVM去分每个类别；
4. 区域改良：对许多重复覆盖的区域进行非最大压制（NMS）。

## 2 HyperColumns
核心：基于SDS基础，在分类器中引入超列的概念，实现对ROI的修正。

针对SDS的第三步改进：基于CNN最后的特征训练SVM去分类->基于高、低层特征融合形成Hypercolumns训练SVM。

Hypercolumns结构：把低层特征和高层特征结合一起，用于分类，改善对细节的探测。
## 3 CFM（Convolutional Feature Masking）
动机：SPP两个作用：1）通过矩形框生成特征图的掩码Mask 2）把任意大小的区域生成一个固定大
小的特征。

引入CFM代替矩形框，用不规则区域生成掩码Mask，提取特征。图像掩码Mask：用选定的图像、图形或物体，对处理的图像（全部或局部）进行遮挡，来控制图像处理的区域或处理过程。
## 4 MNC
改进：用3个任务形成一个级联结构，并共享底层卷积特征，具体来说：
1. 回归边框级实例(Regressing Box-level Instances):采用RPN来预测无分类的bounding box位置和评分；
2. 回归掩码级实例(Regressing Mask-level Instances): 用第一阶段的卷积特征还有bbox作为输入，通过ROIpooling提取特征，加上两个FC层，一是降维，二是回归像素级掩码，得到输出是每一个候选box的像素级语义掩码（DeepMark类似，但因共享特征而节约开销；
3. 实例分类(Categorizing instances):共享特征、阶段一bbox、阶段二Mask作输入，最后输出
每一个实例的分类得分。

这个网络当中，每个阶段都会激活损失函数，但后阶段的损失函数依赖前阶段的输出。
## 5 ISFCN
改进：针对局部的像素进行改善。FCN中，训练一个classifier来预测一个像素属于某个物体类的得分，它是平移不变而且无法区分单个物体实例的。比如，同样的一个像素，既可以是物体1的前景也可以是相邻物体2的背景，两个物体属于同一类，那么FCN产生的每个类只有一个score，是没有办法区分这两种情况的。所以，提出了positive-sensitive score map，每个score表示一个像素在某
个相对位置上属于某个物体实例的得分（R-FCN的position sensitive score map思路用到 instance上）。

具体来说：
1. CNN特征提取，（用vgg16改造）减少网络步长和增加特征图的分辨率，提取效果更好的特征图
；
2. 顶层特征作为两个全卷积分支的输入，一个用于预估部分实例，生成了instance-sensitive score maps（下图上分支的蓝色框）；另一个对对象评分，每个像素通过逻辑回归对以该像素为中心的滑动窗口的实例/非实例进行分类，生成对象评分图。

## 6 FCIS
改进：继续采用Instance-sensitive score maps，加了区分在物体实例内还是外的inside/outside score maps，引入一点context信息；操作是在box proposal上进行，代替了在滑动
窗口操作，具体来说：
1. CNN特征提取，在第4卷积层加上RPN生成300个ROI，另Bbox分支再生成300个ROI，空洞算法处理第5卷积层，然后在第5卷积层生成position-sensitive in/out score map；
2. 通过组装操作前面得到的ROI生成像素级的得分图，主要目的是：1）检测：检测ROI的每一像素是否属于目标Bbox相关的位置上（检测到对象与否）；2）分割：ROI的每一像素是否在对象实例的边界内；
3. 端到端处理（End to End Solution）：softmax操作生成前景可能性，最大化操作生成每一像素的对象分类，最后用平均池化推断分类得分。

## 7 SIS
采用端到端全卷积进行实例感知语义分割，把底层卷积结果和scoremap完全共享于预测和分类的子任务，通过一个无额外参数的新联合方程实现，具体来说：
1. CNN特征提取，用ResNet模型，第4卷积层加上RPN，空洞算法处理第5卷积层，通过融合多尺度及多分区模式生成生成position-sensitive in/out score map（如图二），并第5卷积层添加 新的语义分割子网络生成C+1 score map（C+1种分类可能）；
2. 贝叶斯推断，提高了分割和分类的准确性；
3. softmax操作生成前景可能性，最大化操作生成每一像素的对象分类，最后用平均池化推断分类
得分。
## 8 Mask R-CNN
改进：用FPN进行目标检测，并通过添加额外分支进行语义分割(额外分割分支和原检测分支不共享
参数)，即MaskR-CNN有三个输出分支(分类、坐标回归和分割),一是改进了RoIpooling，通过双线性差值使候选区域和卷积特征的对齐不因量化而损失信息。二是在分割时，MaskR-CNN将判断类别和输出模板(mask)这两个任务解耦合，用sigmoid配合对率(logistic)损失函数对每个类别的模板单
独处理，比经典分割方法用softmax让所有类别一起竞争效果更好。



