# 单层、多层循环神经网络
## 1. 单层循环神经网络
首先循环神经网络的主要用途是处理和预测序列数据。在之前的全链接神经网络或卷积神经网络模型中，网络的结构都是从输入层到隐藏层再到输出层，层与层之间是全链接或者部分连接的，但每层之间的节点是无法连接的。而循环神经网络的隐藏层之间的节点是有连接的，隐藏层的输入不仅包括输入层的输出，还包括上一时刻隐藏层的输出。下面通过一个图来展示一下单层循环神经网络：

<div align=center>
    ![image](https://raw.githubusercontent.com/zhiyuanz-hub/public-picture/master/14-1.png)
</div> 

对于循环神经网络，一个非常重要的概念就是时刻。循环神经网络会对于每一个时刻的输入结合当前模型的状态给出一个输出。从图中可以看到，循环神经网络的主体结构A的输入除了来自输入层Xt，还有一个循环的边来提供当前时刻的状态。在每一个时刻，循环神经网络的模块A会读取t时刻的输入Xt，并输出一个值Ht。同时A的状态会从当前步传递到下一步。

因此，循环神经网络理论上可以被看作是同一神经网络结构被无限复制的结果。但出于优化的考虑，目前循环神经网络无法做到真正的无限循环，所以，现实中一般会将循环体展开进而得到多层循环神经网络。
## 2. 多层循环神经网络
同样的通过一组图来进行展示：

<div align=center>
    ![image](https://raw.githubusercontent.com/zhiyuanz-hub/public-picture/master/14-2.jpg)
</div> 

从图中可以更加清楚的看到循环神经网络在每一个时刻会有一个输入Xt ，然后根据循环神经网络当前的状态At，提供一个输出ht。而循环神经网络的当前状态At是根据上一时刻的的状态At−1和当前的输入Xt共同决定的。从循环神经网络的结构特征可以很容易得出它最擅长解决的问题是与时间序列相关的。循环神经网络也是处理这类问题时最自然的神经网络结构。对于一个序列数据，可以将这个序列上不同时刻的数据依次传入循环神经网络的输入层，而输出可以是对序列中下一个时刻的预测，也可以是对当前时刻信息的处理结果（比如语音识别结果）。循环神经网络要求每一个时刻都有一个输入，但是不一定每一个时刻都需要有输出。
## 3. RNN的应用前景
RNN相对于传统的神经网络，它允许我们对向量序列进行操作：输入序列、输出序列、或大部分的输入输出序列。下面通过一组图来说明RNN的应用前景：

<div align=center>
    ![image](https://raw.githubusercontent.com/zhiyuanz-hub/public-picture/master/14-3.jpg)
</div> 

从左到右：
+ 第一个，没有使用RNN的Vanilla模型，从固定大小的输入得到固定大小输出（比如图像分类）
+ 第二个，序列输出（比如图片字幕，输入一张图片输出一段文字序列）
+ 第三个，序列输入（比如情感分析，输入一段文字然后将它分类成积极或者消极情感）
+ 第四个，序列输入和序列输出（比如机器翻译：一个RNN读取一条英文语句然后将它以法语形式输出）
+ 最后一个，同步序列输入输出（比如视频分类，对视频中每一帧打标签）。我们注意到在每一个案例中，都没有对序列长度进行预先特定约束，因为递归变换（绿色部分）是固定的，而且可以多次使用。

